/*
 * Copyright (c) 2020 The ZMK Contributors
 *
 * SPDX-License-Identifier: MIT
 */

#include <behaviors.dtsi>
#include <dt-bindings/zmk/keys.h>
#include <dt-bindings/zmk/bt.h>
#include <dt-bindings/zmk/ext_power.h>
#include <dt-bindings/zmk/rgb.h>

#define DEFAULT 0
#define LOWER 1
#define RAISE 2
#define SUPER 3

/ {

	combos {
        	compatible = "zmk,combos";
        	combo_super {
            		timeout-ms = <50>;
            		key-positions = <52 56>;
            		bindings = <&mo 3>;
        	};
    	};
	
	behaviors {
		grvesc: grave_escape {
			compatible = "zmk,behavior-mod-morph";
			label = "GRAVE_ESCAPE";
			#binding-cells = <0>;
			bindings = <&kp ESC>, <&kp GRAVE>;
			mods = <(MOD_LSFT)>;
		};
	};
    
	keymap {
		compatible = "zmk,keymap";

		default_layer {
// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------
// |  ESC   |     1     |     2     |     3     |     4     |     5     |                           |     6     |     7     |     8     |     9     |     0     |     -     |
// |  TAB   |     Q     |     D     |     R     |     W     |     B     |                           |     J     |     F     |     U     |     P     |     ;     |    BS     |
// |  CTRL  |     A     |     S     |     H     |     T     |     G     |                           |     Y     |     N     |     E     |     O     |     I     |     '     |
// | LSHIFT |     Z     |     X     |     M     |     C     |     V     |    "["    |   |    "]"    |     K     |     L     |     ,     |     .     |     /     |   ENTER   |
//                                  |     `     |   LALT    |   LOWER   |   SPACE   |   |   SPACE   |  RSHIFT   |   RAISE   |     =     |
			bindings = <
&grvesc     &kp N1      &kp N2      &kp N3      &kp N4      &kp N5                                  &kp N6      &kp N7      &kp N8      &kp N9      &kp N0      &kp MINUS
&kp TAB     &kp Q       &kp D       &kp R       &kp W       &kp B                                   &kp J       &kp F       &kp U       &kp P       &kp SEMI    &kp BSPC
&kp LCTRL   &kp A       &kp S       &kp H       &kp T       &kp G                                   &kp Y       &kp N       &kp E       &kp O       &kp I       &kp SQT
&kp LSHFT   &kp Z       &kp X       &kp M       &kp C       &kp V       &kp LBKT        &kp RBKT    &kp K       &kp L       &kp COMMA   &kp DOT     &kp FSLH    &kp RET
                                    &kp GRAVE   &kp LALT    &mo 1       &kp SPACE       &kp SPACE   &kp RSHFT   &mo 2       &kp EQUAL
			>;

			sensor-bindings = <&inc_dec_kp C_VOL_UP C_VOL_DN>;
		};

		lower_layer {
// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------
// |  LGUI  |     6     |     7     |     8     |     9     |     10    |                           |           |           |           |           |           |    NUM    |
// |        |           |           |           |           |     I     |                           |           |     7     |     8     |     9     |   PSCRN   |           |
// |        |           |           |           |           |           |                           |           |     4     |     5     |     6     |           |           |
// |        |           |           |           |           |     M     |           |   |           |           |     1     |     2     |     3     |           |           |
//                                  |           |           |   LOWER   |           |   |           |     0     |   RAISE   |           |
			bindings = <
&kp LGUI    &kp N6   	&kp N7      &kp N8      &kp N9      &kp N0                                  &trans      &trans      &trans      &trans      &trans      &kp KP_NUM
&trans      &trans      &trans      &trans      &trans      &kp I                                   &trans      &kp KP_N7   &kp KP_N8   &kp KP_N9   &kp PSCRN   &trans
&trans      &trans      &trans      &trans      &trans      &trans                                  &trans      &kp KP_N4   &kp KP_N5   &kp KP_N6   &trans      &trans
&trans      &trans      &trans      &trans      &trans      &kp M       &trans          &trans      &trans      &kp KP_N1   &kp KP_N2   &kp KP_N3   &trans      &trans
                                    &trans      &trans      &mo 1       &trans          &trans      &kp KP_N0   &mo 2       &trans
			>;

			sensor-bindings = <&inc_dec_kp C_VOL_UP C_VOL_DN>;
		};

		raise_layer {
// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------
// |        |           |           |           |           |           |                           |           |           |           |           |           |           |
// |   `    |     1     |     2     |     3     |     4     |     5     |                           |     6     |     7     |     8     |     9     |     0     |    DEL    |
// |   F1   |    F2     |    F3     |    F4     |    F5     |    F6     |                           |           |    <-     |     ^     |     v     |    ->     |           |
// |   F7   |    F8     |    F9     |    F10    |    F11    |    F12    |           |   |           |     +     |     -     |     =     |    "["    |    "]"    |     \     |
//                                  |           |           |   LOWER   |           |   |           |           |   RAISE   |           |
			bindings = <
&trans      &trans      &trans      &trans      &trans      &trans                                  &trans      &trans      &trans      &trans      &trans      &trans
&kp GRAVE   &kp N1      &kp N2      &kp N3      &kp N4      &kp N5                                  &kp N6      &kp N7      &kp N8      &kp N9      &kp N0      &kp DEL
&kp F1      &kp F2      &kp F3      &kp F4      &kp F5      &kp F6                                  &trans      &kp LEFT    &kp UP      &kp DOWN    &kp RIGHT   &trans
&kp F7      &kp F8      &kp F9      &kp F10     &kp F11     &kp F12     &trans          &trans      &kp KP_PLUS &kp MINUS   &kp EQUAL   &kp LBKT    &kp RBKT    &kp BSLH
                                    &trans      &trans      &mo 1       &trans          &trans      &trans      &mo 2       &trans
			>;

			sensor-bindings = <&inc_dec_kp C_VOL_UP C_VOL_DN>;
		};
		
		super_layer {
// ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
// |   LGUI     |                   |                   |                   |                   |                   |                           |                   |                   |                   |                   |                   |                   |
// |            |                   |                   |                   |                   |                   |                           |                   |                   |                   |                   |                   |                   |
// |   BTCLR    |        BT1        |        BT2        |        BT3        |        BT4        |        BT5        |                           |                   |                   |                   |                   |                   |                   |
// |            |       EP_ON       |       EP_OFF      |      EP_TOG       |                   |                   |           |   |           |                   |                   |                   |                   |                   |                   |
//                                                      |                   |                   |       LOWER       |           |   |           |                   |       RAISE       |                   |
			bindings = <
&kp LGUI        &trans              &trans              &trans              &trans              &trans                                          &trans              &trans              &trans              &trans              &trans              &trans
&trans          &trans              &trans 	        &trans              &trans              &trans                                          &trans              &trans              &trans              &trans              &trans              &trans
&bt BT_CLR      &bt BT_SEL 0        &bt BT_SEL 1        &bt BT_SEL 2        &bt BT_SEL 3        &bt BT_SEL 4                                    &trans              &trans              &trans              &trans              &trans              &trans
&trans          &ext_power EP_ON    &ext_power EP_OFF   &ext_power EP_TOG   &trans              &trans              &trans          &trans      &trans              &trans              &trans              &trans              &trans              &trans
                                                        &trans              &trans              &mo 1               &trans          &trans      &trans              &mo 2               &trans
			>;

			sensor-bindings = <&inc_dec_kp C_VOL_UP C_VOL_DN>;
		};
	};
};
